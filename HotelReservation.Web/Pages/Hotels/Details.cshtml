@page
@model HotelReservation.Web.Pages.Hotels.DetailsModel

@{
    ViewData["Title"] = "Otel Detayı";
}

@if (Model.Hotel == null)
{
    <div class="alert alert-danger">
        Otel bulunamadı.
    </div>
}
else
{
    <div class="mb-3">
        <a asp-page="./Index" class="btn btn-link">&larr; Otel listesine dön</a>
    </div>

    <div class="row">
        <div class="col-md-5">
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <h3 class="card-title">@Model.Hotel.Name</h3>
                    <h6 class="card-subtitle mb-2 text-muted">
                        @Model.Hotel.City
                    </h6>
                    <p class="card-text">
                        <strong>Adres:</strong> @Model.Hotel.Address
                    </p>
                    <p class="card-text">
                        <strong>Açıklama:</strong> @Model.Hotel.Description
                    </p>
                    <p class="card-text">
                        <strong>Ortalama Puan:</strong>
                        @{
                            var avg = Model.GetAverageRating();
                        }
                        @if (avg.HasValue)
                        {
                            @avg.Value.ToString("0.0") @: / 5
                        }
                        else
                        {
                            <span>Henüz yorum yok</span>
                        }
                    </p>
                </div>
            </div>
        </div>

        <div class="col-md-7">
            <h4>Odalar</h4>

            @if (Model.Hotel.Rooms == null || !Model.Hotel.Rooms.Any())
            {
                <div class="alert alert-info">
                    Bu otelde henüz tanımlı oda bulunmuyor.
                </div>
            }
            else
            {
                <table class="table table-striped table-hover align-middle">
                    <thead>
                        <tr>
                            <th>Oda No</th>
                            <th>Kapasite</th>
                            <th>Gecelik Fiyat</th>
                            <th>Açıklama</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    @foreach (var room in Model.Hotel.Rooms)
                    {
                        <tr>
                            <td>@room.RoomNumber</td>
                            <td>@room.Capacity</td>
                            <td>@room.PricePerNight.ToString("C")</td>
                            <td>@room.Description</td>
                            <td>
                                <a asp-page="/Reservations/Create"
                                   asp-route-roomId="@room.Id"
                                   class="btn btn-sm btn-success">
                                    Rezervasyon Yap
                                </a>

                            </td>
                        </tr>
                    }
                    </tbody>
                </table>
            }
        </div>
    </div>
}
